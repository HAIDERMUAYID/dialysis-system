# ๐ฅ ููุฒุฉ "ุฒูุงุฑุฉ ูู ุฎูุงู ุงูุทุจูุจ" - Doctor-Directed Visit Feature

## โ ุงูููุฒุฉ ุงููุถุงูุฉ

ุชู ุฅุถุงูุฉ ููุฒุฉ ุฌุฏูุฏุฉ ุชุณูุญ ูููุธู ุงูุงุณุชุนูุงูุงุช ุจุฅูุดุงุก ุฒูุงุฑุฉ ุชุจุฏุฃ ูุจุงุดุฑุฉ ุนูุฏ ุงูุทุจูุจุ ุญูุซ ูููู ุงูุทุจูุจ ุจุงุฎุชูุงุฑ ุงูุชุญุงููู ูุงูุฃุฏููุฉ ุงููุทููุจุฉ ูู ุงููุชุงููุฌุงุชุ ุซู ุชุตู ุงูุฃูุงูุฑ ุงููุฎุชุงุฑุฉ ููุท ุฅูู ุงููุฎุชุจุฑ ูุงูุตูุฏููุฉ.

---

## ๐ ุงูุชุฏูู ุงููุงูู

### 1๏ธโฃ **ููุธู ุงูุงุณุชุนูุงูุงุช**
- ุนูุฏ ุฅูุดุงุก ุฒูุงุฑุฉ ุฌุฏูุฏุฉุ ูุธูุฑ ุฎูุงุฑุงู:
  - โ **ุฒูุงุฑุฉ ุนุงุฏูุฉ** (ููุง ูู ุงูุขู) - ุชุจุฏุฃ ุนูุฏ ุงููุฎุชุจุฑ
  - โ **ุฒูุงุฑุฉ ูู ุฎูุงู ุงูุทุจูุจ** (ุฌุฏูุฏ) - ุชุจุฏุฃ ุนูุฏ ุงูุทุจูุจ

### 2๏ธโฃ **ุงูุทุจูุจ**
- ุนูุฏ ูุชุญ ุฒูุงุฑุฉ ูู ุฎูุงู ุงูุทุจูุจ:
  - ูุธูุฑ ูู ูุงูุฐุฉ ุงุฎุชูุงุฑ ุงูุชุญุงููู ูุงูุฃุฏููุฉ
  - ููููู ุงุฎุชูุงุฑ:
    - โ ุชุญุงููู ููุท
    - โ ุฃุฏููุฉ ููุท
    - โ ุงูุงุซููู ูุนุงู
    - โ ุนุฏู ุงุฎุชูุงุฑ ุฃู ุดูุก (ุชูุชูู ุงูุฒูุงุฑุฉ ุนูุฏ ุงูุทุจูุจ)

### 3๏ธโฃ **ุงููุฎุชุจุฑ**
- ุฅุฐุง ุงุฎุชุงุฑ ุงูุทุจูุจ ุชุญุงููู:
  - ุชุตู ูููุฎุชุจุฑ ุฒูุงุฑุฉ ูู ุฎูุงู ุงูุทุจูุจ
  - ุชุญุชูู ููุท ุนูู ุงูุชุญุงููู ุงูุชู ุงุฎุชุงุฑูุง ุงูุทุจูุจ
  - ููุธู ุงููุฎุชุจุฑ ููุชุจ ูููุฉ ุงูุชุญููู ููุท ุซู ูุคูุฏ
  - **ูุง ูููู ุฅุถุงูุฉ ุชุญุงููู ุฌุฏูุฏุฉ** - ููุท ุชุนุฏูู ุงููุชุงุฆุฌ

### 4๏ธโฃ **ุงูุตูุฏููุฉ**
- ุฅุฐุง ุงุฎุชุงุฑ ุงูุทุจูุจ ุฃุฏููุฉ:
  - ุชุตู ููุตูุฏููุฉ ุฒูุงุฑุฉ ูู ุฎูุงู ุงูุทุจูุจ
  - ุชุญุชูู ููุท ุนูู ุงูุฃุฏููุฉ ุงูุชู ุงุฎุชุงุฑูุง ุงูุทุจูุจ
  - ููุธู ุงูุตูุฏููุฉ ููุชุจ ูููุฉ ุงูุนูุงุฌ ุงููุตุฑูู ููุท ุซู ูุคูุฏ
  - **ูุง ูููู ุฅุถุงูุฉ ุฃุฏููุฉ ุฌุฏูุฏุฉ** - ููุท ุชุนุฏูู ุงููููุงุช

### 5๏ธโฃ **ุฅููุงุก ุงูุฒูุงุฑุฉ**
- ุฅุฐุง ูู ูุฑุณู ุงูุทุจูุจ ูููุฎุชุจุฑ ุฃู ุงูุตูุฏููุฉ โ ุชูุชูู ุงูุฒูุงุฑุฉ ูุจุงุดุฑุฉ ุนูุฏ ุงูุทุจูุจ
- ุฅุฐุง ุฃุฑุณู ูุฃุญุฏ ุงูุฃูุณุงู ุฃู ููุงููุง โ ุชูุชูู ุงูุฒูุงุฑุฉ ุจุนุฏ ุชุฃููุฏ ุชูููุฐ ุงูุทูุจุงุช

---

## ๐ง ุงูุชุบููุฑุงุช ุงูุชูููุฉ

### **ูุงุนุฏุฉ ุงูุจูุงูุงุช**
1. โ ุฅุถุงูุฉ ุญูู `visit_type` ูู ุฌุฏูู `visits`:
   - `'normal'` (ุงูุชุฑุงุถู) - ุฒูุงุฑุฉ ุนุงุฏูุฉ
   - `'doctor_directed'` - ุฒูุงุฑุฉ ูู ุฎูุงู ุงูุทุจูุจ

### **Backend (API)**
1. โ ุชุนุฏูู `POST /api/visits`:
   - ูุจูู `visit_type` ูู body
   - ุฅูุดุงุก ุฒูุงุฑุฉ ุจุญุงูุฉ `pending_doctor` ุฅุฐุง ูุงูุช `doctor_directed`
   - ุฅุฑุณุงู ุฅุดุนุงุฑ ููุทุจูุจ ููุท

2. โ ุฅุถุงูุฉ `POST /api/doctor/select-items/:visitId`:
   - ูุจูู `lab_test_ids` ู `drug_ids`
   - ุฅูุดุงุก `lab_results` ู `pharmacy_prescriptions` ูู ุงููุชุงููุฌุงุช
   - ุชุญุฏูุซ ุญุงูุฉ ุงูุฒูุงุฑุฉ ุญุณุจ ุงูุงุฎุชูุงุฑุงุช

### **Frontend**
1. โ ุชุนุฏูู `VisitForm.tsx`:
   - ุฅุถุงูุฉ Radio buttons ูุงุฎุชูุงุฑ ููุน ุงูุฒูุงุฑุฉ
   - ุฅุฑุณุงู `visit_type` ุนูุฏ ุฅูุดุงุก ุงูุฒูุงุฑุฉ

2. โ ุฅูุดุงุก `DoctorVisitSelection.tsx`:
   - ูุงูุฐุฉ ุงุฎุชูุงุฑ ุงูุชุญุงููู ูุงูุฃุฏููุฉ ูู ุงููุชุงููุฌุงุช
   - ุจุญุซ ูู ุงููุชุงููุฌุงุช
   - ุนุฑุถ ููุฎุต ุงูุงุฎุชูุงุฑุงุช

3. โ ุชุนุฏูู `VisitDetailsModern.tsx`:
   - ุฅุธูุงุฑ `DoctorVisitSelection` ุชููุงุฆูุงู ููุฒูุงุฑุงุช ูู ุฎูุงู ุงูุทุจูุจ
   - ููุน ุฅุถุงูุฉ ุชุญุงููู/ุฃุฏููุฉ ุฌุฏูุฏุฉ ูู ุงูุฒูุงุฑุงุช ูู ุฎูุงู ุงูุทุจูุจ
   - ุฅุธูุงุฑ Tag "ุฒูุงุฑุฉ ูู ุฎูุงู ุงูุทุจูุจ" ูู ูุงุฌูุฉ ุงููุฎุชุจุฑ ูุงูุตูุฏููุฉ

---

## ๐ ุงููููุงุช ุงููุถุงูุฉ/ุงููุนุฏูุฉ

### **Backend**
- โ `server/database/db.js` - ุฅุถุงูุฉ migration ูู `visit_type`
- โ `prisma/schema.prisma` - ุฅุถุงูุฉ `visitType` field
- โ `server/routes/visits.js` - ุฏุนู `visit_type` ูู ุฅูุดุงุก ุงูุฒูุงุฑุฉ
- โ `server/routes/doctor.js` - ุฅุถุงูุฉ endpoint `select-items`

### **Frontend**
- โ `client/src/types/index.ts` - ุฅุถุงูุฉ `visit_type` ูู `Visit` interface
- โ `client/src/components/Visits/VisitForm.tsx` - ุฅุถุงูุฉ ุฎูุงุฑ ููุน ุงูุฒูุงุฑุฉ
- โ `client/src/components/Doctor/DoctorVisitSelection.tsx` - ูููู ุฌุฏูุฏ
- โ `client/src/components/Visits/VisitDetailsModern.tsx` - ุฏุนู ุงูุฒูุงุฑุงุช ูู ุฎูุงู ุงูุทุจูุจ

---

## ๐ฏ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

โ **ุงูุฒูุงุฑุฉ ุงูุฌุฏูุฏุฉ ุชูุฏุงุฑ ุจุงููุงูู ุญุณุจ ุงุฎุชูุงุฑ ุงูุทุจูุจ**
โ **ูุง ูุชู ุชูููุฐ ุฃู ุชุญููู ุฃู ุฏูุงุก ุฅูุง ุฅุฐุง ุงุฎุชุงุฑู ุงูุทุจูุจ ุจููุณู**
โ **ุงููุฎุชุจุฑ ูุงูุตูุฏููุฉ ูุง ูุถูููู ุนูุงุตุฑ ุฌุฏูุฏุฉุ ููุท ูููุฐูู ูุง ุชู ุงุฎุชูุงุฑู**

---

## ๐ ุงูุฃูุงู ูุงูุงุณุชูุฑุงุฑ

- โ **Backward Compatible**: ุงูุฒูุงุฑุงุช ุงููุฏููุฉ ุชุนูู ุจุดูู ุทุจูุนู (`visit_type = 'normal'`)
- โ **Optional Field**: `visit_type` ุงุฎุชูุงุฑูุ ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ `'normal'`
- โ **Validation**: ุงูุชุญูู ูู ููุน ุงูุฒูุงุฑุฉ ูุจู ุงูุณูุงุญ ุจุฅุถุงูุฉ ุนูุงุตุฑ ุฌุฏูุฏุฉ
- โ **User Feedback**: ุฑุณุงุฆู ูุงุถุญุฉ ูููุณุชุฎุฏููู ุนูุฏ ูุญุงููุฉ ุฅุถุงูุฉ ุนูุงุตุฑ ูู ุงูุฒูุงุฑุงุช ูู ุฎูุงู ุงูุทุจูุจ

---

## ๐ ููุงุญุธุงุช

- ุงูููุฒุฉ **ุขููุฉ ุชูุงูุงู** ููุง ุชุคุซุฑ ุนูู ุงููุธุงู ุงูุญุงูู
- ุฌููุน ุงูุฒูุงุฑุงุช ุงููุฏููุฉ ุชุจูู `visit_type = 'normal'`
- ูููู ุงุณุชุฎุฏุงู ุงูููุฒุฉ ุงูุฌุฏูุฏุฉ ุฃู ุงูุงุณุชูุฑุงุฑ ุจุงูุทุฑููุฉ ุงููุฏููุฉ

---

**ุชู ุงูุชูููุฐ ุจูุฌุงุญ! ๐**
