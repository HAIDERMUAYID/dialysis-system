# استكشاف الأخطاء وإصلاحها

## مشكلة: "فشل تسجيل الدخول"

إذا كنت تواجه رسالة خطأ "فشل تسجيل الدخول"، اتبع الخطوات التالية:

### 1. تأكد من تشغيل الخادم (Backend)

في terminal منفصل، قم بتشغيل:

```bash
# من المجلد الرئيسي للمشروع
npm run server
```

يجب أن ترى رسالة:
```
Connected to SQLite database
Server is running on port 5000
Database initialized successfully
```

### 2. تأكد من تشغيل الواجهة الأمامية (Frontend)

في terminal آخر، قم بتشغيل:

```bash
# من المجلد الرئيسي للمشروع
npm run client
```

أو قم بتشغيل كلاهما معاً:

```bash
npm run dev
```

### 3. تحقق من أن الخادم يعمل

افتح المتصفح وانتقل إلى:
```
http://localhost:5000/api/auth/login
```

يجب أن ترى رسالة خطأ JSON (هذا طبيعي، يعني أن الخادم يعمل).

### 4. تحقق من قاعدة البيانات

تأكد من وجود ملف `database.sqlite` في المجلد الرئيسي للمشروع.

إذا لم يكن موجوداً، سيتم إنشاؤه تلقائياً عند تشغيل الخادم لأول مرة.

### 5. تحقق من الحسابات الافتراضية

الحسابات الافتراضية تُنشأ تلقائياً عند أول تشغيل للخادم:

- **موظف الاستعلامات**: `inquiry` / `inquiry123`
- **موظف التحليلات**: `lab` / `lab123`
- **الصيدلي**: `pharmacist` / `pharmacist123`
- **الطبيب**: `doctor` / `doctor123`

### 6. مشاكل شائعة

#### الخادم لا يستجيب
- تأكد من أن المنفذ 5000 غير مستخدم
- تحقق من أن جميع المتطلبات مثبتة: `npm install`

#### خطأ "ECONNREFUSED"
- تأكد من تشغيل الخادم قبل الواجهة الأمامية
- تحقق من أن `proxy` في `client/package.json` مضبوط على `http://localhost:5000`

#### خطأ في قاعدة البيانات
- احذف ملف `database.sqlite` إذا كان موجوداً
- أعد تشغيل الخادم لإنشاء قاعدة بيانات جديدة

#### كلمة المرور غير صحيحة
- استخدم الحسابات الافتراضية المذكورة أعلاه
- تأكد من عدم وجود مسافات زائدة عند نسخ/لصق

### 7. تسجيل الأخطاء

للحصول على مزيد من المعلومات حول الخطأ:

1. افتح Developer Tools في المتصفح (F12)
2. انتقل إلى تبويب Console
3. انتقل إلى تبويب Network
4. حاول تسجيل الدخول مرة أخرى
5. تحقق من طلبات HTTP والأخطاء

### 8. إعادة التشغيل الكاملة

إذا لم تحل المشكلة، جرب:

```bash
# 1. أوقف جميع العمليات
# Ctrl+C في جميع terminals

# 2. احذف node_modules وإعادة التثبيت
rm -rf node_modules client/node_modules
npm install
cd client && npm install && cd ..

# 3. احذف قاعدة البيانات وإعادة الإنشاء
rm -f database.sqlite

# 4. أعد تشغيل النظام
npm run dev
```

## دعم إضافي

إذا استمرت المشكلة، تحقق من:
- إصدار Node.js (يجب أن يكون 14 أو أحدث)
- إصدار npm
- أن جميع الحزم مثبتة بشكل صحيح
